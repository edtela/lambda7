<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baryon π-Algebra Tree</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
    <script src="https://unpkg.com/elkjs@0.8.2/lib/elk.bundled.js"></script>
    <script src="https://unpkg.com/cytoscape-elk@2.2.0/dist/cytoscape-elk.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #1a1a2e; color: #eee; }
        #container { display: flex; height: 100vh; }
        #graph-area { flex: 1; display: flex; flex-direction: column; }
        #main-tabs { display: flex; background: #0f0f23; border-bottom: 2px solid #333; }
        .main-tab {
            padding: 12px 24px; cursor: pointer; color: #888; font-size: 1em;
            border: none; background: transparent; border-bottom: 3px solid transparent;
        }
        .main-tab:hover { color: #ccc; background: #16213e; }
        .main-tab.active { color: #00d9ff; border-bottom-color: #00d9ff; background: #16213e; }
        #cy { flex: 1; background: #16213e; }
        #sidebar { width: 380px; padding: 20px; background: #0f0f23; overflow-y: auto; border-left: 1px solid #333; }
        h1 { font-size: 1.3em; margin-bottom: 15px; color: #00d9ff; }
        h2 { font-size: 1em; margin: 15px 0 10px 0; color: #ff6b6b; }
        #info {
            background: #1a1a2e; padding: 15px; border-radius: 8px;
            font-family: monospace; font-size: 1.1em; line-height: 1.9;
        }
        .formula { color: #00d9ff; font-size: 1.15em; }
        .value { color: #2ecc71; }
        .label { color: #888; }
        .pos { color: #e74c3c; }
        .neg { color: #3498db; }
        button { background: #16213e; color: #eee; border: 1px solid #444; padding: 8px 12px; margin: 3px; cursor: pointer; border-radius: 4px; }
        button:hover { background: #1f4068; border-color: #00d9ff; }
        .legend { margin-top: 20px; font-size: 0.9em; }
        .legend-item { display: flex; align-items: center; margin: 8px 0; }
        .legend-color { width: 20px; height: 20px; border-radius: 4px; margin-right: 10px; border: 2px solid #fff; }
        #main-tabs { display: flex; justify-content: space-between; align-items: center; }
        .tab-buttons { display: flex; }
        .zoom-controls { display: flex; margin-right: 10px; }
        .zoom-controls button { padding: 6px 12px; margin: 0 2px; }
        #decays {
            background: #1a1a2e; padding: 15px; border-radius: 8px;
            margin-top: 15px; font-size: 1.05em; line-height: 1.7;
        }
        .decay-mode {
            margin: 8px 0; padding: 8px; background: #16213e;
            border-radius: 4px; border-left: 3px solid #444;
        }
        .decay-mode.strong { border-left-color: #e74c3c; }
        .decay-mode.weak { border-left-color: #f39c12; }
        .decay-mode.em { border-left-color: #9b59b6; }
        .decay-percent { float: right; color: #2ecc71; font-weight: bold; }
        .decay-type { font-size: 0.75em; color: #888; margin-top: 4px; }
    </style>
</head>
<body>
    <div id="container">
        <div id="graph-area">
            <div id="main-tabs">
                <div class="tab-buttons">
                    <button class="main-tab active" onclick="switchTab('light')">Light (6π⁵)</button>
                    <button class="main-tab" onclick="switchTab('charm')">Charm (14π⁵)</button>
                    <button class="main-tab" onclick="switchTab('bottom')">Bottom (36π⁵)</button>
                </div>
                <div class="zoom-controls">
                    <button onclick="cy.zoom(cy.zoom() / 1.2); cy.center()">−</button>
                    <button onclick="cy.fit(50)">Fit</button>
                    <button onclick="cy.zoom(cy.zoom() * 1.2); cy.center()">+</button>
                </div>
            </div>
            <div id="cy"></div>
        </div>
        <div id="sidebar">
            <h1>Baryon π-Algebra Tree</h1>
            <div id="info"><p style="color: #666;">Click a node to see details</p></div>
            <h2>Decays</h2>
            <div id="decays"><p style="color: #666;">Select a particle to see decay modes</p></div>
            <div class="legend">
                <h2>Legend</h2>
                <div class="legend-item"><div class="legend-color" style="background: #3498db;"></div>Spin-1/2</div>
                <div class="legend-item"><div class="legend-color" style="background: #e74c3c;"></div>Spin-3/2</div>
                <div class="legend-item"><div class="legend-color" style="background: #9b59b6; border-style: dashed;"></div>Strangeness level (+π⁵)</div>
                <div class="legend-item"><div class="legend-color" style="background: #8e44ad; border-radius: 0;"></div>Coefficient base (resonances)</div>
            </div>
            <div class="legend">
                <h2>Decay Types</h2>
                <div class="legend-item"><div class="legend-color" style="background: transparent; border-color: #e74c3c;"></div>Strong (~10⁻²³ s)</div>
                <div class="legend-item"><div class="legend-color" style="background: transparent; border-color: #f39c12;"></div>Weak (~10⁻¹⁰ s)</div>
                <div class="legend-item"><div class="legend-color" style="background: transparent; border-color: #9b59b6;"></div>EM (~10⁻²⁰ s)</div>
            </div>
        </div>
    </div>
    <script>
        const datasets = {
            light: { nodes: [
        {
                "id": "root6",
                "label": "6\u03c0\u2075",
                "sublabel": "S=0",
                "type": "virtual",
                "formula": "6\u03c0\u2075",
                "description": "Light baryon base (S=0)"
        },
        {
                "id": "p",
                "label": "p",
                "sublabel": "",
                "type": "particle",
                "formula": "6\u03c0\u2075",
                "correction": "+(4/5)e\u207b\u1d56\u2071",
                "mass_me": 1836.1181087116884,
                "actual_mev": 938.27208816,
                "residual_me": 0.03456471357026203,
                "charge": "+1",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 938.2720914411451,
                "base_mev": 938.2544256276585,
                "corr_mev": 0.017665813486538756,
                "error_kev": 0.0032811451546876924,
                "sigma": 11314.293636854112,
                "uncertainty": 2.9e-10
        },
        {
                "id": "n",
                "label": "n",
                "sublabel": "",
                "type": "particle",
                "formula": "6\u03c0\u2075",
                "correction": "+8/\u03c0",
                "mass_me": 1836.1181087116884,
                "actual_mev": 939.56542052,
                "residual_me": 2.565553006207665,
                "charge": "0",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 939.5556737685748,
                "base_mev": 938.2544256276585,
                "corr_mev": 1.3012481409162924,
                "error_kev": -9.746751425154798,
                "sigma": 18049539.67621259,
                "uncertainty": 5.4e-10
        },
        {
                "id": "vD6pi4",
                "label": "+6\u03c0\u2074",
                "sublabel": "\u0394 base",
                "type": "virtual",
                "formula": "6\u03c0\u2075 + 6\u03c0\u2074",
                "description": "Delta decuplet base (6\u03c0\u2074)"
        },
        {
                "id": "D",
                "label": "\u0394",
                "sublabel": "-\u03c0\u00b2",
                "type": "spin32",
                "formula": "6\u03c0\u2075 + 6\u03c0\u2074 - \u03c0\u00b2",
                "correction": null,
                "mass_me": 2410.7030505146136,
                "actual_mev": 1232.0,
                "residual_me": 0.2608076303008602,
                "charge": "++,+,0,-",
                "spin": "3/2",
                "strangeness": 0,
                "calc_mev": 1232.0010639177135,
                "base_mev": 1231.8667275747644,
                "corr_mev": 0.13433634294895835,
                "error_kev": 1.0639177135089994,
                "sigma": 0.0005319588567544997,
                "uncertainty": 2.0
        },
        {
                "id": "v7",
                "label": "+\u03c0\u2075",
                "sublabel": "S=-1",
                "type": "virtual",
                "formula": "7\u03c0\u2075",
                "description": "Strangeness -1 level"
        },
        {
                "id": "L0",
                "label": "\u039b",
                "sublabel": "\u03c0\u00b3 + \u03c0\u00b2",
                "type": "particle",
                "formula": "7\u03c0\u2075 + \u03c0\u00b3 + \u03c0\u00b2",
                "correction": "+1/\u03c0",
                "mass_me": 2183.0136745783593,
                "actual_mev": 1115.683,
                "residual_me": 0.3234927485013941,
                "charge": "0",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 1115.6803515627976,
                "base_mev": 1115.5176955451832,
                "corr_mev": 0.16265601761453655,
                "error_kev": -2.6484372024242475,
                "sigma": 0.44140620040404127,
                "uncertainty": 0.006
        },
        {
                "id": "vS6pi3",
                "label": "+6\u03c0\u00b3",
                "sublabel": "\u03a3 base",
                "type": "virtual",
                "formula": "7\u03c0\u2075 + 6\u03c0\u00b3",
                "description": "Sigma octet base (6\u03c0\u00b3)"
        },
        {
                "id": "S_plus",
                "label": "\u03a3\u207a",
                "sublabel": "",
                "type": "particle",
                "formula": "7\u03c0\u2075 + 6\u03c0\u00b3",
                "correction": "-2/\u03c0",
                "mass_me": 2328.175453578769,
                "actual_mev": 1189.37,
                "residual_me": -0.6364243889829595,
                "charge": "+1",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 1189.3699001592954,
                "base_mev": 1189.6952121945246,
                "corr_mev": -0.3253120352290731,
                "error_kev": -0.09984070447899285,
                "sigma": 0.003328023482633095,
                "uncertainty": 0.03
        },
        {
                "id": "S_zero",
                "label": "\u03a3\u2070",
                "sublabel": "\u03c0\u00b2",
                "type": "particle",
                "formula": "7\u03c0\u2075 + 6\u03c0\u00b3 + \u03c0\u00b2",
                "correction": "-4",
                "mass_me": 2338.0450579798585,
                "actual_mev": 1192.642,
                "residual_me": -4.102884517466464,
                "charge": "0",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 1192.6945738803968,
                "base_mev": 1194.7385696803967,
                "corr_mev": -2.0439958,
                "error_kev": 52.573880396721506,
                "sigma": 1.752462679890717,
                "uncertainty": 0.03
        },
        {
                "id": "S_minus",
                "label": "\u03a3\u207b",
                "sublabel": "2\u03c0\u00b2",
                "type": "particle",
                "formula": "7\u03c0\u2075 + 6\u03c0\u00b3 + 2\u03c0\u00b2",
                "correction": "-23/5",
                "mass_me": 2347.914662380948,
                "actual_mev": 1197.449,
                "residual_me": -4.565424579187038,
                "charge": "-1",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 1197.431331996269,
                "base_mev": 1199.7819271662688,
                "corr_mev": -2.3505951699999996,
                "error_kev": -17.668003731159843,
                "sigma": 0.44170009327899606,
                "uncertainty": 0.04
        },
        {
                "id": "vSs6pi4",
                "label": "+6\u03c0\u2074",
                "sublabel": "\u03a3* base",
                "type": "virtual",
                "formula": "7\u03c0\u2075 + 6\u03c0\u2074",
                "description": "Sigma* decuplet base (6\u03c0\u2074)"
        },
        {
                "id": "Ss_plus",
                "label": "\u03a3*\u207a",
                "sublabel": "-2\u03c0\u00b2",
                "type": "spin32",
                "formula": "7\u03c0\u2075 + 6\u03c0\u2074 - 2\u03c0\u00b2",
                "correction": null,
                "mass_me": 2706.853130898806,
                "actual_mev": 1382.8,
                "residual_me": -0.7810342731668243,
                "charge": "+1",
                "spin": "3/2",
                "strangeness": -1,
                "calc_mev": 1382.800362819593,
                "base_mev": 1383.1991076935021,
                "corr_mev": -0.3987448739092151,
                "error_kev": 0.36281959296502464,
                "sigma": 0.0004031328810722496,
                "uncertainty": 0.9
        },
        {
                "id": "Ss_zero",
                "label": "\u03a3*\u2070",
                "sublabel": "-2\u03c0\u00b2",
                "type": "spin32",
                "formula": "7\u03c0\u2075 + 6\u03c0\u2074 - 2\u03c0\u00b2",
                "correction": "+1",
                "mass_me": 2706.853130898806,
                "actual_mev": 1383.7,
                "residual_me": 0.9802217920364455,
                "charge": "0",
                "spin": "3/2",
                "strangeness": -1,
                "calc_mev": 1383.7101066435023,
                "base_mev": 1383.1991076935021,
                "corr_mev": 0.51099895,
                "error_kev": 10.106643502240331,
                "sigma": 0.011229603891378146,
                "uncertainty": 0.9
        },
        {
                "id": "Ss_minus",
                "label": "\u03a3*\u207b",
                "sublabel": "-\u03c0\u00b2",
                "type": "spin32",
                "formula": "7\u03c0\u2075 + 6\u03c0\u2074 - \u03c0\u00b2",
                "correction": "-2",
                "mass_me": 2716.7227352998952,
                "actual_mev": 1387.2,
                "residual_me": -2.0400534665955092,
                "charge": "-1",
                "spin": "3/2",
                "strangeness": -1,
                "calc_mev": 1387.2204672793744,
                "base_mev": 1388.2424651793742,
                "corr_mev": -1.0219979,
                "error_kev": 20.467279374315694,
                "sigma": 0.022741421527017438,
                "uncertainty": 0.9
        },
        {
                "id": "v8",
                "label": "+\u03c0\u2075",
                "sublabel": "S=-2",
                "type": "virtual",
                "formula": "8\u03c0\u2075",
                "description": "Strangeness -2 level (Xi)"
        },
        {
                "id": "vXpi4pi3",
                "label": "+\u03c0\u2074+\u03c0\u00b3",
                "sublabel": "\u039e base",
                "type": "virtual",
                "formula": "8\u03c0\u2075 + \u03c0\u2074 + \u03c0\u00b3",
                "description": "Xi octet base"
        },
        {
                "id": "X_zero",
                "label": "\u039e\u2070",
                "sublabel": "",
                "type": "particle",
                "formula": "8\u03c0\u2075 + \u03c0\u2074 + \u03c0\u00b3",
                "correction": "-\u03c0 - 1/\u03c0",
                "mass_me": 2576.5728459965535,
                "actual_mev": 1314.86,
                "residual_me": -3.4560127819254376,
                "charge": "0",
                "spin": "1/2",
                "strangeness": -2,
                "calc_mev": 1314.8580123378238,
                "base_mev": 1316.6260189027505,
                "corr_mev": -1.7680065649266343,
                "error_kev": -1.9876621761341084,
                "sigma": 0.024845777201676356,
                "uncertainty": 0.08
        },
        {
                "id": "X_minus",
                "label": "\u039e\u207b",
                "sublabel": "\u03c0\u00b2",
                "type": "particle",
                "formula": "8\u03c0\u2075 + \u03c0\u2074 + \u03c0\u00b3 + \u03c0\u00b2",
                "correction": "+1/5\u03c0",
                "mass_me": 2586.442450397643,
                "actual_mev": 1321.71,
                "residual_me": 0.07949842436573817,
                "charge": "-1",
                "spin": "1/2",
                "strangeness": -2,
                "calc_mev": 1321.7019075921453,
                "base_mev": 1321.6693763886226,
                "corr_mev": 0.0325312035229073,
                "error_kev": -8.092407854746853,
                "sigma": 0.1348734642457809,
                "uncertainty": 0.06
        },
        {
                "id": "vXs6pi4",
                "label": "+6\u03c0\u2074-\u03c0\u00b3",
                "sublabel": "\u039e* base",
                "type": "virtual",
                "formula": "8\u03c0\u2075 + 6\u03c0\u2074 - \u03c0\u00b3",
                "description": "Xi* decuplet base"
        },
        {
                "id": "Xs_zero",
                "label": "\u039e*\u2070",
                "sublabel": "",
                "type": "spin32",
                "formula": "8\u03c0\u2075 + 6\u03c0\u2074 - \u03c0\u00b3",
                "correction": "-(1/5)(5\u03c0 + 4)",
                "mass_me": 3001.605747805966,
                "actual_mev": 1531.8,
                "residual_me": -3.94792483000856,
                "charge": "0",
                "spin": "3/2",
                "strangeness": -2,
                "calc_mev": 1531.8032357355012,
                "base_mev": 1533.8173854428132,
                "corr_mev": -2.014149707312098,
                "error_kev": 3.2357355012209155,
                "sigma": 0.004044669376526144,
                "uncertainty": 0.8
        },
        {
                "id": "Xs_minus",
                "label": "\u039e*\u207b",
                "sublabel": "",
                "type": "spin32",
                "formula": "8\u03c0\u2075 + 6\u03c0\u2074 - \u03c0\u00b3",
                "correction": "(1/5)(4\u03c0 - 1)",
                "mass_me": 3001.605747805966,
                "actual_mev": 1535.0,
                "residual_me": 2.314318957380692,
                "charge": "-1",
                "spin": "3/2",
                "strangeness": -2,
                "calc_mev": 1534.999466090663,
                "base_mev": 1533.8173854428132,
                "corr_mev": 1.1820806478496784,
                "error_kev": -0.5339093370366754,
                "sigma": 0.0005932325967074172,
                "uncertainty": 0.9
        },
        {
                "id": "v9",
                "label": "+\u03c0\u2075",
                "sublabel": "S=-3",
                "type": "virtual",
                "formula": "9\u03c0\u2075",
                "description": "Strangeness -3 level (Omega)"
        },
        {
                "id": "Om",
                "label": "\u03a9\u207b",
                "sublabel": "6\u03c0\u2074 - 2\u03c0\u00b3",
                "type": "spin32",
                "formula": "9\u03c0\u2075 + 6\u03c0\u2074 - 2\u03c0\u00b3",
                "correction": "-(6/5)(\u03c0 - e\u207b\u1d56\u2071)",
                "mass_me": 3276.6191559109475,
                "actual_mev": 1672.45,
                "residual_me": -3.7161489673908363,
                "charge": "-1",
                "spin": "3/2",
                "strangeness": -3,
                "calc_mev": 1672.4490262838356,
                "base_mev": 1674.3489482203804,
                "corr_mev": -1.899921936544709,
                "error_kev": -0.9737161644807202,
                "sigma": 0.004636743640384382,
                "uncertainty": 0.21
        }
], edges: [
        {
                "source": "root6",
                "target": "p"
        },
        {
                "source": "root6",
                "target": "n"
        },
        {
                "source": "root6",
                "target": "vD6pi4"
        },
        {
                "source": "vD6pi4",
                "target": "D"
        },
        {
                "source": "root6",
                "target": "v7"
        },
        {
                "source": "v7",
                "target": "L0"
        },
        {
                "source": "v7",
                "target": "vS6pi3"
        },
        {
                "source": "vS6pi3",
                "target": "S_plus"
        },
        {
                "source": "vS6pi3",
                "target": "S_zero"
        },
        {
                "source": "vS6pi3",
                "target": "S_minus"
        },
        {
                "source": "v7",
                "target": "vSs6pi4"
        },
        {
                "source": "vSs6pi4",
                "target": "Ss_plus"
        },
        {
                "source": "vSs6pi4",
                "target": "Ss_zero"
        },
        {
                "source": "vSs6pi4",
                "target": "Ss_minus"
        },
        {
                "source": "v7",
                "target": "v8"
        },
        {
                "source": "v8",
                "target": "vXpi4pi3"
        },
        {
                "source": "vXpi4pi3",
                "target": "X_zero"
        },
        {
                "source": "vXpi4pi3",
                "target": "X_minus"
        },
        {
                "source": "v8",
                "target": "vXs6pi4"
        },
        {
                "source": "vXs6pi4",
                "target": "Xs_zero"
        },
        {
                "source": "vXs6pi4",
                "target": "Xs_minus"
        },
        {
                "source": "v8",
                "target": "v9"
        },
        {
                "source": "v9",
                "target": "Om"
        }
] },
            charm: { nodes: [
        {
                "id": "root14",
                "label": "14\u03c0\u2075",
                "sublabel": "C=1",
                "type": "virtual",
                "formula": "14\u03c0\u2075",
                "description": "Charm baryon base (C=1)"
        },
        {
                "id": "Lc",
                "label": "\u039bc\u207a",
                "sublabel": "2\u03c0\u2074",
                "type": "particle",
                "formula": "14\u03c0\u2075 + 2\u03c0\u2074",
                "correction": "-23/5",
                "mass_me": 4479.093769061945,
                "actual_mev": 2286.46,
                "residual_me": -4.603165901214197,
                "charge": "+1",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 2286.461617772196,
                "base_mev": 2288.812212942196,
                "corr_mev": -2.3505951699999996,
                "error_kev": 1.617772195913858,
                "sigma": 0.011555515685098985,
                "uncertainty": 0.14
        },
        {
                "id": "vSc",
                "label": "+5\u03c0\u2074+\u03c0\u00b3",
                "sublabel": "\u03a3c base",
                "type": "virtual",
                "formula": "14\u03c0\u2075 + 5\u03c0\u2074 + \u03c0\u00b3",
                "description": "Sigma_c base"
        },
        {
                "id": "Sc_pp",
                "label": "\u03a3c\u207a\u207a",
                "sublabel": "",
                "type": "particle",
                "formula": "14\u03c0\u2075 + 5\u03c0\u2074 + \u03c0\u00b3",
                "correction": null,
                "mass_me": 4802.327318844252,
                "actual_mev": 2453.97,
                "residual_me": -0.02782292552274157,
                "charge": "2",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 2453.969746746265,
                "base_mev": 2453.9842174857276,
                "corr_mev": -0.014470739462419613,
                "error_kev": -0.2532537346269237,
                "sigma": 0.001808955247335169,
                "uncertainty": 0.14
        },
        {
                "id": "Sc_plus",
                "label": "\u03a3c\u207a",
                "sublabel": "",
                "type": "particle",
                "formula": "14\u03c0\u2075 + 5\u03c0\u2074 + \u03c0\u00b3",
                "correction": null,
                "mass_me": 4802.327318844252,
                "actual_mev": 2452.9,
                "residual_me": -2.1217606919299214,
                "charge": "1",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 2452.903432014115,
                "base_mev": 2453.9842174857276,
                "corr_mev": -1.0807854716127412,
                "error_kev": 3.432014114878257,
                "sigma": 0.008580035287195642,
                "uncertainty": 0.4
        },
        {
                "id": "Sc_zero",
                "label": "\u03a3c\u2070",
                "sublabel": "",
                "type": "particle",
                "formula": "14\u03c0\u2075 + 5\u03c0\u2074 + \u03c0\u00b3",
                "correction": null,
                "mass_me": 4802.327318844252,
                "actual_mev": 2453.75,
                "residual_me": -0.4583521859049142,
                "charge": "0",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 2453.74997181304,
                "base_mev": 2453.9842174857276,
                "corr_mev": -0.234245672687902,
                "error_kev": -0.028186960207676748,
                "sigma": 0.0002013354300548339,
                "uncertainty": 0.14
        },
        {
                "id": "vScs",
                "label": "+6\u03c0\u2074+2\u03c0\u00b3",
                "sublabel": "\u03a3c* base",
                "type": "virtual",
                "formula": "14\u03c0\u2075 + 6\u03c0\u2074 + 2\u03c0\u00b3",
                "description": "Sigma_c* base"
        },
        {
                "id": "Scs_pp",
                "label": "\u03a3c*\u207a\u207a",
                "sublabel": "",
                "type": "spin32",
                "formula": "14\u03c0\u2075 + 6\u03c0\u2074 + 2\u03c0\u00b3",
                "correction": null,
                "mass_me": 4930.742686558554,
                "actual_mev": 2518.41,
                "residual_me": -2.337256371270996,
                "charge": "2",
                "spin": "3/2",
                "strangeness": 0,
                "calc_mev": 2518.407784164288,
                "base_mev": 2519.6043355516,
                "corr_mev": -1.196551387312098,
                "error_kev": -2.2158357119224092,
                "sigma": 0.005539589279806023,
                "uncertainty": 0.4
        },
        {
                "id": "Scs_plus",
                "label": "\u03a3c*\u207a",
                "sublabel": "",
                "type": "spin32",
                "formula": "14\u03c0\u2075 + 6\u03c0\u2074 + 2\u03c0\u00b3",
                "correction": null,
                "mass_me": 4930.742686558554,
                "actual_mev": 2517.5,
                "residual_me": -4.118081948308827,
                "charge": "1",
                "spin": "3/2",
                "strangeness": 0,
                "calc_mev": 2517.5024567937503,
                "base_mev": 2519.6043355516,
                "corr_mev": -2.101878757849678,
                "error_kev": 2.4567937502979476,
                "sigma": 0.004913587500595895,
                "uncertainty": 0.5
        },
        {
                "id": "Scs_zero",
                "label": "\u03a3c*\u2070",
                "sublabel": "",
                "type": "spin32",
                "formula": "14\u03c0\u2075 + 6\u03c0\u2074 + 2\u03c0\u00b3",
                "correction": "-11/5",
                "mass_me": 4930.742686558554,
                "actual_mev": 2518.48,
                "residual_me": -2.200269788420883,
                "charge": "0",
                "spin": "3/2",
                "strangeness": 0,
                "calc_mev": 2518.4801378616,
                "base_mev": 2519.6043355516,
                "corr_mev": -1.12419769,
                "error_kev": 0.13786159979645163,
                "sigma": 0.00034465399949112907,
                "uncertainty": 0.4
        },
        {
                "id": "v15",
                "label": "+\u03c0\u2075",
                "sublabel": "S=-1",
                "type": "virtual",
                "formula": "15\u03c0\u2075",
                "description": "Charm + strange"
        },
        {
                "id": "vXc",
                "label": "+2\u03c0\u2074+\u03c0\u00b3",
                "sublabel": "\u039ec base",
                "type": "virtual",
                "formula": "15\u03c0\u2075 + 2\u03c0\u2074 + \u03c0\u00b3",
                "description": "Xi_c base"
        },
        {
                "id": "Xc_plus",
                "label": "\u039ec\u207a",
                "sublabel": "\u03c0\u00b2",
                "type": "particle",
                "formula": "15\u03c0\u2075 + 2\u03c0\u2074 + \u03c0\u00b3 + \u03c0\u00b2",
                "correction": null,
                "mass_me": 4825.989334928615,
                "actual_mev": 2467.71,
                "residual_me": 3.1986702522181076,
                "charge": "+1",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 2467.709774885957,
                "base_mev": 2466.0754828597205,
                "corr_mev": 1.634292026236937,
                "error_kev": -0.22511404313263483,
                "sigma": 0.0007261743326859189,
                "uncertainty": 0.31
        },
        {
                "id": "Xc_zero",
                "label": "\u039ec\u2070",
                "sublabel": "2\u03c0\u00b2",
                "type": "particle",
                "formula": "15\u03c0\u2075 + 2\u03c0\u2074 + \u03c0\u00b3 + 2\u03c0\u00b2",
                "correction": null,
                "mass_me": 4835.858939329704,
                "actual_mev": 2470.44,
                "residual_me": -1.32845741775418,
                "charge": "0",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 2470.4332879082804,
                "base_mev": 2471.118840345592,
                "corr_mev": -0.6855524373120979,
                "error_kev": -6.712091719691671,
                "sigma": 0.023971756141755965,
                "uncertainty": 0.28
        },
        {
                "id": "vXcs",
                "label": "+6\u03c0\u2074",
                "sublabel": "\u039ec* base",
                "type": "virtual",
                "formula": "15\u03c0\u2075 + 6\u03c0\u2074",
                "description": "Xi_c* base"
        },
        {
                "id": "Xcs_plus",
                "label": "\u039ec*\u207a",
                "sublabel": "",
                "type": "spin32",
                "formula": "15\u03c0\u2075 + 6\u03c0\u2074",
                "correction": "+4\u03c0/5",
                "mass_me": 5174.7498179832355,
                "actual_mev": 2645.57,
                "residual_me": 2.501524705434349,
                "charge": "1",
                "spin": "3/2",
                "strangeness": -1,
                "calc_mev": 2645.576003939974,
                "base_mev": 2644.291723502124,
                "corr_mev": 1.2842804378496784,
                "error_kev": 6.00393997365245,
                "sigma": 0.0120078799473049,
                "uncertainty": 0.5
        },
        {
                "id": "Xcs_zero",
                "label": "\u039ec*\u2070",
                "sublabel": "",
                "type": "spin32",
                "formula": "15\u03c0\u2075 + 6\u03c0\u2074",
                "correction": "+13\u03c0/10",
                "mass_me": 5174.7498179832355,
                "actual_mev": 2646.38,
                "residual_me": 4.086655164117474,
                "charge": "0",
                "spin": "3/2",
                "strangeness": -1,
                "calc_mev": 2646.3786792136298,
                "base_mev": 2644.291723502124,
                "corr_mev": 2.0869557115057273,
                "error_kev": -1.3207863703428302,
                "sigma": 0.0026415727406856604,
                "uncertainty": 0.5
        },
        {
                "id": "v16",
                "label": "+\u03c0\u2075",
                "sublabel": "S=-2",
                "type": "virtual",
                "formula": "16\u03c0\u2075",
                "description": "Charm + double strange"
        },
        {
                "id": "Oc_zero",
                "label": "\u03a9c\u2070",
                "sublabel": "4\u03c0\u2074 - \u03c0\u00b2",
                "type": "particle",
                "formula": "16\u03c0\u2075 + 4\u03c0\u2074 - \u03c0\u00b2",
                "correction": null,
                "mass_me": 5276.081716299423,
                "actual_mev": 2695.2,
                "residual_me": -1.7068863707108903,
                "charge": "0",
                "spin": "1/2",
                "strangeness": -2,
                "calc_mev": 2695.1967358653533,
                "base_mev": 2696.0722171432026,
                "corr_mev": -0.8754812778496783,
                "error_kev": -3.264134646542516,
                "sigma": 0.015543498316869124,
                "uncertainty": 0.21
        },
        {
                "id": "Ocs_zero",
                "label": "\u03a9c*\u2070",
                "sublabel": "5\u03c0\u2074 + \u03c0\u00b3",
                "type": "spin32",
                "formula": "16\u03c0\u2075 + 5\u03c0\u2074 + \u03c0\u00b3",
                "correction": "-8/5",
                "mass_me": 5414.366688414814,
                "actual_mev": 2765.9,
                "residual_me": -1.6354098084684665,
                "charge": "0",
                "spin": "3/2",
                "strangeness": -2,
                "calc_mev": 2765.9180943749466,
                "base_mev": 2766.735692694947,
                "corr_mev": -0.81759832,
                "error_kev": 18.094374946485914,
                "sigma": 0.03618874989297183,
                "uncertainty": 0.5
        },
        {
                "id": "Xcc",
                "label": "\u039ecc\u207a\u207a",
                "sublabel": "7\u03c0\u2076 - 14\u03c0\u2075 + 3\u03c0\u2074 + 2\u03c0\u00b3",
                "type": "particle",
                "formula": "7\u03c0\u2076 + 3\u03c0\u2074 + 2\u03c0\u00b3",
                "correction": null,
                "mass_me": 7083.964181489737,
                "actual_mev": 3621.55,
                "residual_me": 3.2323773290254394,
                "charge": "++",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 3621.5547090211767,
                "base_mev": 3619.8982585788644,
                "corr_mev": 1.6564504423120978,
                "error_kev": 4.709021176495298,
                "sigma": 0.011772552941238246,
                "uncertainty": 0.4
        }
], edges: [
        {
                "source": "root14",
                "target": "Lc"
        },
        {
                "source": "root14",
                "target": "vSc"
        },
        {
                "source": "vSc",
                "target": "Sc_pp"
        },
        {
                "source": "vSc",
                "target": "Sc_plus"
        },
        {
                "source": "vSc",
                "target": "Sc_zero"
        },
        {
                "source": "root14",
                "target": "vScs"
        },
        {
                "source": "vScs",
                "target": "Scs_pp"
        },
        {
                "source": "vScs",
                "target": "Scs_plus"
        },
        {
                "source": "vScs",
                "target": "Scs_zero"
        },
        {
                "source": "root14",
                "target": "v15"
        },
        {
                "source": "v15",
                "target": "vXc"
        },
        {
                "source": "vXc",
                "target": "Xc_plus"
        },
        {
                "source": "vXc",
                "target": "Xc_zero"
        },
        {
                "source": "v15",
                "target": "vXcs"
        },
        {
                "source": "vXcs",
                "target": "Xcs_plus"
        },
        {
                "source": "vXcs",
                "target": "Xcs_zero"
        },
        {
                "source": "v15",
                "target": "v16"
        },
        {
                "source": "v16",
                "target": "Oc_zero"
        },
        {
                "source": "v16",
                "target": "Ocs_zero"
        },
        {
                "source": "root14",
                "target": "Xcc"
        }
] },
            bottom: { nodes: [
        {
                "id": "root36",
                "label": "36\u03c0\u2075",
                "sublabel": "B=-1",
                "type": "virtual",
                "formula": "36\u03c0\u2075",
                "description": "Bottom baryon base (B=-1)"
        },
        {
                "id": "Lb",
                "label": "\u039bb\u2070",
                "sublabel": "-2\u03c0\u00b2",
                "type": "particle",
                "formula": "36\u03c0\u2075 - 2\u03c0\u00b2",
                "correction": "+\u03c0/10",
                "mass_me": 10996.969443467951,
                "actual_mev": 5619.6,
                "residual_me": 0.31342766123816546,
                "charge": "0",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 5619.600373848938,
                "base_mev": 5619.439838794207,
                "corr_mev": 0.1605350547312098,
                "error_kev": 0.3738489376701182,
                "sigma": 0.0062308156278353035,
                "uncertainty": 0.06
        },
        {
                "id": "Sb_plus",
                "label": "\u03a3b\u207a",
                "sublabel": "3\u03c0\u2074 + \u03c0\u00b3 + 2\u03c0\u00b2",
                "type": "particle",
                "formula": "36\u03c0\u2075 + 3\u03c0\u2074 + \u03c0\u00b3 + 2\u03c0\u00b2",
                "correction": "+18\u03c0/5",
                "mass_me": 11359.681410854617,
                "actual_mev": 5810.56,
                "residual_me": 11.300858287033407,
                "charge": "+1",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 5810.564535251551,
                "base_mev": 5804.785273281227,
                "corr_mev": 5.779261970323552,
                "error_kev": 4.535251550805697,
                "sigma": 0.009070503101611394,
                "uncertainty": 0.5
        },
        {
                "id": "Sb_minus",
                "label": "\u03a3b\u207b",
                "sublabel": "5\u03c0\u2074 - 3\u03c0\u00b3 - 3\u03c0\u00b2",
                "type": "particle",
                "formula": "36\u03c0\u2075 + 5\u03c0\u2074 - 3\u03c0\u00b3 - 3\u03c0\u00b2",
                "correction": "-1/5",
                "mass_me": 11381.126464195975,
                "actual_mev": 5815.64,
                "residual_me": -0.2028830418439611,
                "charge": "-1",
                "spin": "1/2",
                "strangeness": 0,
                "calc_mev": 5815.641473231355,
                "base_mev": 5815.743673021356,
                "corr_mev": -0.10219979,
                "error_kev": 1.4732313547938247,
                "sigma": 0.0029464627095876494,
                "uncertainty": 0.5
        },
        {
                "id": "v37",
                "label": "+\u03c0\u2075",
                "sublabel": "S=-1",
                "type": "virtual",
                "formula": "37\u03c0\u2075",
                "description": "Bottom + strange"
        },
        {
                "id": "Xb_zero",
                "label": "\u039eb\u2070",
                "sublabel": "\u03c0\u2074 - 3\u03c0\u00b3 + \u03c0\u00b2",
                "type": "particle",
                "formula": "37\u03c0\u2075 + \u03c0\u2074 - 3\u03c0\u00b3 + \u03c0\u00b2",
                "correction": "-4\u03c0/5",
                "mass_me": 11336.988202449604,
                "actual_mev": 5791.9,
                "residual_me": -2.522642393169008,
                "charge": "0",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 5791.904787176285,
                "base_mev": 5793.189067614135,
                "corr_mev": -1.2842804378496784,
                "error_kev": 4.78717628539016,
                "sigma": 0.0119679407134754,
                "uncertainty": 0.4
        },
        {
                "id": "Xb_minus",
                "label": "\u039eb\u207b",
                "sublabel": "\u03c0\u2074 - \u03c0\u00b3 - 3\u03c0\u00b2",
                "type": "particle",
                "formula": "37\u03c0\u2075 + \u03c0\u2074 - \u03c0\u00b3 - 3\u03c0\u00b2",
                "correction": "-24\u03c0/5",
                "mass_me": 11359.522338205847,
                "actual_mev": 5797.0,
                "residual_me": -15.07632711326005,
                "charge": "-1",
                "spin": "1/2",
                "strangeness": -1,
                "calc_mev": 5796.998304697634,
                "base_mev": 5804.703987324732,
                "corr_mev": -7.70568262709807,
                "error_kev": -1.6953023659880273,
                "sigma": 0.004238255914970068,
                "uncertainty": 0.4
        },
        {
                "id": "v38",
                "label": "+\u03c0\u2075",
                "sublabel": "S=-2",
                "type": "virtual",
                "formula": "38\u03c0\u2075",
                "description": "Bottom + double strange"
        },
        {
                "id": "Ob",
                "label": "\u03a9b\u207b",
                "sublabel": "2\u03c0\u2074 - \u03c0\u00b2",
                "type": "particle",
                "formula": "38\u03c0\u2075 + 2\u03c0\u2074 - \u03c0\u00b2",
                "correction": "+29\u03c0/5",
                "mass_me": 11813.696599507612,
                "actual_mev": 6046.1,
                "residual_me": 18.22595140956946,
                "charge": "-1",
                "spin": "1/2",
                "strangeness": -2,
                "calc_mev": 6046.09759114137,
                "base_mev": 6036.78655796696,
                "corr_mev": 9.311033174410168,
                "error_kev": -2.408858630587929,
                "sigma": 0.010949357411763313,
                "uncertainty": 0.22
        }
], edges: [
        {
                "source": "root36",
                "target": "Lb"
        },
        {
                "source": "root36",
                "target": "Sb_plus"
        },
        {
                "source": "root36",
                "target": "Sb_minus"
        },
        {
                "source": "root36",
                "target": "v37"
        },
        {
                "source": "v37",
                "target": "Xb_zero"
        },
        {
                "source": "v37",
                "target": "Xb_minus"
        },
        {
                "source": "v37",
                "target": "v38"
        },
        {
                "source": "v38",
                "target": "Ob"
        }
] }
        };
        let cy, currentTab = 'light';

        function buildElements(data) {
            const elements = [];
            data.nodes.forEach(n => {
                let nodeType = n.type;
                // Distinguish virtual node subtypes:
                // - 'virtual': strangeness levels (root nodes, +π⁵ nodes) -> ellipse
                // - 'virtual-coeff': coefficient bases (+6π⁴, +6π³, etc.) -> hexagon
                if (n.type === 'virtual') {
                    const isStrangenessLevel = n.id.startsWith('root') || n.label === '+π⁵';
                    nodeType = isStrangenessLevel ? 'virtual' : 'virtual-coeff';
                }
                const lbl = (nodeType === 'virtual' || nodeType === 'virtual-coeff')
                    ? n.label : (n.sublabel ? n.label + '\n' + n.sublabel : n.label);
                // Assign partition: 0=octet(left), 1=virtual(center), 2=decuplet(right)
                let partition = 1; // default: center
                if (n.type === 'particle') partition = 0;  // octet left
                if (n.type === 'spin32') partition = 2;    // decuplet right
                elements.push({
                    data: { ...n, id: n.id, label: lbl, type: nodeType },
                    layoutOptions: {
                        'elk.partitioning.partition': partition
                    }
                });
            });
            data.edges.forEach((e, i) => elements.push({ data: { id: 'e'+i, source: e.source, target: e.target } }));
            return elements;
        }

        function initCy(tab) {
            const elements = buildElements(datasets[tab]);
            cy = cytoscape({
                container: document.getElementById('cy'),
                elements: elements,
                style: [
                    { selector: 'node[type="particle"]', style: {
                        'label': 'data(label)', 'text-valign': 'center', 'text-halign': 'center',
                        'font-size': '16px', 'font-weight': 'bold', 'color': '#fff',
                        'text-wrap': 'wrap', 'text-max-width': '150px',
                        'shape': 'round-rectangle', 'width': 120, 'height': 55,
                        'background-color': '#3498db', 'border-width': 2, 'border-color': '#fff'
                    } },
                    { selector: 'node[type="spin32"]', style: {
                        'label': 'data(label)', 'text-valign': 'center', 'text-halign': 'center',
                        'font-size': '16px', 'font-weight': 'bold', 'color': '#fff',
                        'text-wrap': 'wrap', 'text-max-width': '150px',
                        'shape': 'round-rectangle', 'width': 120, 'height': 55,
                        'background-color': '#e74c3c', 'border-width': 2, 'border-color': '#fff'
                    } },
                    { selector: 'node[type="virtual"]', style: {
                        'label': 'data(label)', 'text-valign': 'center', 'text-halign': 'center',
                        'font-size': '16px', 'color': '#fff', 'text-wrap': 'wrap',
                        'shape': 'ellipse', 'width': 70, 'height': 70, 'background-color': '#9b59b6',
                        'border-width': 2, 'border-style': 'dashed', 'border-color': '#fff'
                    } },
                    { selector: 'node[type="virtual-coeff"]', style: {
                        'label': 'data(label)', 'text-valign': 'center', 'text-halign': 'center',
                        'font-size': '14px', 'color': '#fff', 'text-wrap': 'wrap',
                        'shape': 'hexagon', 'width': 80, 'height': 80, 'background-color': '#8e44ad',
                        'border-width': 2, 'border-style': 'solid', 'border-color': '#fff'
                    } },
                    { selector: 'edge', style: { 'width': 2, 'line-color': '#555', 'target-arrow-color': '#555', 'target-arrow-shape': 'triangle', 'curve-style': 'bezier' } },
                    { selector: 'node:selected', style: { 'border-color': '#00d9ff', 'border-width': 5 } }
                ],
                layout: {
                    name: 'elk',
                    elk: {
                        algorithm: 'layered',
                        'elk.direction': 'DOWN',
                        'elk.spacing.nodeNode': 60,
                        'elk.layered.spacing.nodeNodeBetweenLayers': 100,
                        'elk.partitioning.activate': true,
                        'elk.layered.crossingMinimization.strategy': 'LAYER_SWEEP'
                    },
                    padding: 30
                }
            });
            cy.on('tap', 'node', e => showInfo(e.target.data()));
            cy.on('tap', e => { if(e.target === cy) document.getElementById('info').innerHTML = '<p style="color:#666">Click a node</p>'; });
        }

        // Magnetic moments from data/magnetic.py
        const magMoments = {
            'p': { formula: '8π/9', value: 2.792527, exp: 2.7928473508, unit: 'μN', sign: '' },
            'S_plus': { formula: '7π/9', value: 2.443461, exp: 2.458, unit: 'μN', sign: '' },
            'n': { formula: '6/π', value: 1.909859, exp: 1.9130427, unit: 'μN', sign: '-' },
            'L0': { formula: '6/π²', value: 0.607927, exp: 0.613, unit: 'μN', sign: '-' },
            'X_zero': { formula: '4/π', value: 1.273240, exp: 1.25, unit: 'μN', sign: '-' },
            'S_minus': { formula: '36/π³', value: 1.161055, exp: 1.16, unit: 'μN', sign: '-' },
            'X_minus': { formula: '20/π³', value: 0.645031, exp: 0.6507, unit: 'μN', sign: '-' },
            'Om': { formula: '20/π²', value: 2.026424, exp: 2.02, unit: 'μN', sign: '-' }
        };

        // Resonances from data/resonances.py
        const resonances = {
            'Lambda_1405': {
                symbol: 'Λ(1405)',
                jp: '1/2-',
                formula: '9π⁵ - π - 1 - 1/π',
                calc_mev: 1405.103,
                exp_mev: 1405.1,
                error_kev: 2.6,
                width: 50.5,
                anomaly: 'Too light by ~100-200 MeV; may be K̄N molecular state'
            },
            'Roper': {
                symbol: 'N(1440)',
                jp: '1/2+',
                formula: '9π⁵ + 2π³ + π²/2 - π',
                calc_mev: 1439.986,
                exp_mev: 1440.0,
                error_kev: -13.7,
                width: 300.0,
                anomaly: 'First radial excitation appears below orbital excitations'
            },
            'N_1535': {
                symbol: 'N(1535)',
                jp: '1/2-',
                formula: '9π⁵ + 2π⁴ + π²/2 + π/3',
                calc_mev: 1509.990,
                exp_mev: 1510.0,
                error_kev: -9.7,
                width: 170.0,
                anomaly: 'Nearly degenerate with opposite-parity Roper'
            },
            'Lambda_1520': {
                symbol: 'Λ(1520)',
                jp: '3/2-',
                formula: '9π⁵ + 2π⁴ + π³ - 2π - 1/(2π)',
                calc_mev: 1519.486,
                exp_mev: 1519.5,
                error_kev: -14.3,
                width: 15.6,
                anomaly: 'Unusually narrow width; well-established D-wave state'
            },
            'N_1680': {
                symbol: 'N(1680)',
                jp: '5/2+',
                formula: '9π⁵ + 6π⁴ - π³ - π² - 1/π',
                calc_mev: 1684.987,
                exp_mev: 1685.0,
                error_kev: -12.9,
                width: 130.0,
                anomaly: 'F15 resonance; shares 9π⁵ + 6π⁴ base structure'
            },
            'Delta_1700': {
                symbol: 'Δ(1700)',
                jp: '3/2-',
                formula: '9π⁵ + 6π⁴ - π² - 2',
                calc_mev: 1699.972,
                exp_mev: 1700.0,
                error_kev: -28.1,
                width: 300.0,
                anomaly: 'D33 resonance; shares 9π⁵ + 6π⁴ base structure'
            },
            'X_3872': {
                symbol: 'X(3872)',
                jp: '1++',
                formula: '8π⁶ - π⁵ + 2π⁴ - π - 1/(2π)',
                calc_mev: 3871.640,
                exp_mev: 3871.65,
                error_kev: -9.6,
                width: 1.19,
                anomaly: 'Sits exactly at D⁰D̄*⁰ threshold; likely molecular or tetraquark'
            },
            'N_2190': {
                symbol: 'N(2190)',
                jp: '7/2-',
                formula: 'π⁷ + π⁶ + π⁵ - 2',
                calc_mev: 2189.989,
                exp_mev: 2190.0,
                error_kev: -10.7,
                width: 500.0,
                anomaly: 'High-spin G17 resonance; mass equals [3]_π · π⁵ - 2 (q-integer structure)'
            }
        };

        // Virtual node to resonance mapping from data/cycle.py
        const nodeResonances = {
            'vD6pi4': ['Delta_1700'],
            'v7': ['Lambda_1405'],
            'vS6pi3': ['Roper'],
            'vSs6pi4': ['N_1535'],
            'vXpi4pi3': ['N_1680'],
            'vXs6pi4': ['Lambda_1520'],
            'vOm6pi4': ['Delta_1700']
        };

        // Mesons from data/mesons.py
        const mesons = {
            'pi_pm': {
                symbol: 'π±',
                name: 'Pion±',
                formula: 'π⁵ -π³ -π +1 + 6e^{-π}',
                calc_mev: 139.570,
                exp_mev: 139.57039,
                error_kev: -0.7,
                quark_content: 'ud̄'
            },
            'pi_0': {
                symbol: 'π⁰',
                name: 'Pion⁰',
                formula: 'π⁵ -π³ -π² -1',
                calc_mev: 134.977,
                exp_mev: 134.9768,
                error_kev: 0.4,
                quark_content: 'uū, dd̄'
            },
            'rho': {
                symbol: 'ρ',
                name: 'Rho',
                formula: '5π⁵ -π² -6/5π +2/5',
                calc_mev: 775.113,
                exp_mev: 775.11,
                error_kev: 3.3,
                quark_content: 'ud̄'
            },
            'omega': {
                symbol: 'ω',
                name: 'Omega',
                formula: '5π⁵ +3/5π -2/5',
                calc_mev: 782.637,
                exp_mev: 782.66,
                error_kev: -22.5,
                quark_content: 'uū, dd̄'
            },
            'K_pm': {
                symbol: 'K±',
                name: 'Kaon±',
                formula: '3π⁵ +π³ +2π² -4/5π',
                calc_mev: 493.774,
                exp_mev: 493.677,
                error_kev: 96.8,
                quark_content: 'us̄'
            },
            'K_0': {
                symbol: 'K⁰',
                name: 'Kaon⁰',
                formula: '3π⁵ +2π³ -2π',
                calc_mev: 497.605,
                exp_mev: 497.611,
                error_kev: -6.1,
                quark_content: 'ds̄'
            },
            'eta': {
                symbol: 'η',
                name: 'Eta',
                formula: '3π⁵ +π⁴ +2π³ -2π +1',
                calc_mev: 547.892,
                exp_mev: 547.862,
                error_kev: 29.8,
                quark_content: 'uū, dd̄, ss̄'
            },
            'eta_prime': {
                symbol: 'η\'',
                name: 'Eta\'',
                formula: '6π⁵ +π³ +2π +1',
                calc_mev: 957.820,
                exp_mev: 957.78,
                error_kev: 40.3,
                quark_content: 'uū, dd̄, ss̄'
            },
            'phi': {
                symbol: 'φ',
                name: 'Phi',
                formula: '6π⁵ +2π⁴ -π³ -7/5π -2/5',
                calc_mev: 1019.510,
                exp_mev: 1019.461,
                error_kev: 49.2,
                quark_content: 'ss̄'
            },
            'D_pm': {
                symbol: 'D±',
                name: 'D±',
                formula: '12π⁵ -2π² +2π',
                calc_mev: 1869.633,
                exp_mev: 1869.66,
                error_kev: -27.2,
                quark_content: 'cd̄'
            },
            'D_0': {
                symbol: 'D⁰',
                name: 'D⁰',
                formula: '12π⁵ -2π² -π',
                calc_mev: 1864.817,
                exp_mev: 1864.84,
                error_kev: -23.2,
                quark_content: 'cū'
            },
            'D_s': {
                symbol: 'Ds',
                name: 'Ds',
                formula: '13π⁵ -π⁴ -π³ +4/5π -2/5',
                calc_mev: 1968.344,
                exp_mev: 1968.35,
                error_kev: -5.6,
                quark_content: 'cs̄'
            },
            'J_psi': {
                symbol: 'J/ψ',
                name: 'J/ψ',
                formula: '20π⁵ -2π³ +4/5π -2/5',
                calc_mev: 3096.906,
                exp_mev: 3096.9,
                error_kev: 6.3,
                quark_content: 'cc̄'
            },
            'B_pm': {
                symbol: 'B±',
                name: 'B±',
                formula: '34π⁵ -2π³ -3π -9/5',
                calc_mev: 5279.351,
                exp_mev: 5279.34,
                error_kev: 10.9,
                quark_content: 'ub̄'
            },
            'B_0': {
                symbol: 'B⁰',
                name: 'B⁰',
                formula: '34π⁵ -2π³ -3π -6/5',
                calc_mev: 5279.657,
                exp_mev: 5279.65,
                error_kev: 7.5,
                quark_content: 'db̄'
            },
            'B_s': {
                symbol: 'Bs',
                name: 'Bs',
                formula: '34π⁵ +π⁴ +4/5π -9/5',
                calc_mev: 5366.916,
                exp_mev: 5366.92,
                error_kev: -4.5,
                quark_content: 'sb̄'
            },
            'Upsilon': {
                symbol: 'Υ',
                name: 'Υ(1S)',
                formula: '61π⁵ -π⁴ -2π³ +6/5π +9/5',
                calc_mev: 9460.302,
                exp_mev: 9460.3,
                error_kev: 1.9,
                quark_content: 'bb̄'
            }
        };

        // Virtual node to meson mapping from data/cycle.py
        const nodeMesons = {
            'v7': ['eta_prime'],
            'vS6pi3': ['K_0'],
            'vXs6pi4': ['phi']
        };

        function getSigmaColor(sigma) {
            if (sigma < 1) return '#2ecc71';      // green
            if (sigma < 2) return '#3498db';      // blue
            if (sigma < 3) return '#f39c12';      // orange
            return '#e74c3c';                      // red
        }

        function showInfo(d) {
            if (d.type === 'virtual' || d.type === 'virtual-coeff') {
                // Get resonances for this virtual node
                const resKeys = nodeResonances[d.id] || [];
                let resHtml = '';

                if (resKeys.length > 0) {
                    resHtml = `<hr style="border-color:#333; margin:12px 0">
                        <div style="color:#e74c3c; font-size:0.9em; margin-bottom:8px;">RESONANCES</div>`;

                    for (const key of resKeys) {
                        const res = resonances[key];
                        if (res) {
                            const errorSign = res.error_kev >= 0 ? '+' : '';
                            resHtml += `
                                <div style="margin-bottom:12px; padding:10px; background:#252540; border-radius:4px;">
                                    <div style="font-size:1.4em; color:#fff; margin-bottom:4px;">${res.symbol} <span style="font-size:0.5em; color:#888; margin-left:4px;">${res.jp}</span></div>
                                    <div style="font-size:1.0em; margin-bottom:4px; display:flex; justify-content:space-between;">
                                        <span class="formula">${res.formula}</span>
                                        <span style="color:#888">${res.calc_mev.toFixed(2)}</span>
                                    </div>
                                    <div style="font-size:0.85em; color:#888; margin-bottom:6px;">
                                        <span>Exp: ${res.exp_mev} MeV</span>
                                        <span style="margin-left:12px; color:${Math.abs(res.error_kev) < 50 ? '#2ecc71' : '#f39c12'}">${errorSign}${res.error_kev.toFixed(1)} keV</span>
                                    </div>
                                    <div style="font-size:0.85em; color:#888; margin-bottom:6px;">
                                        <span>Width Γ = ${res.width} MeV</span>
                                    </div>
                                    <div style="font-size:0.8em; color:#f39c12; font-style:italic; line-height:1.4;">${res.anomaly}</div>
                                </div>`;
                        }
                    }
                }

                // Get mesons for this virtual node
                const mesonKeys = nodeMesons[d.id] || [];
                let mesonHtml = '';

                if (mesonKeys.length > 0) {
                    mesonHtml = `<hr style="border-color:#333; margin:12px 0">
                        <div style="color:#2ecc71; font-size:0.9em; margin-bottom:8px;">MESONS</div>`;

                    for (const key of mesonKeys) {
                        const m = mesons[key];
                        if (m) {
                            const errorSign = m.error_kev >= 0 ? '+' : '';
                            mesonHtml += `
                                <div style="margin-bottom:12px; padding:10px; background:#1a3a2a; border-radius:4px; border-left:3px solid #2ecc71;">
                                    <div style="font-size:1.4em; color:#fff; margin-bottom:4px;">${m.symbol} <span style="font-size:0.6em; color:#888; margin-left:4px;">${m.quark_content}</span></div>
                                    <div style="font-size:1.0em; margin-bottom:4px; display:flex; justify-content:space-between;">
                                        <span class="formula">${m.formula}</span>
                                        <span style="color:#888">${m.calc_mev.toFixed(2)}</span>
                                    </div>
                                    <div style="font-size:0.85em; color:#888; margin-bottom:6px;">
                                        <span>Exp: ${m.exp_mev} MeV</span>
                                        <span style="margin-left:12px; color:${Math.abs(m.error_kev) < 500 ? '#2ecc71' : '#f39c12'}">${errorSign}${m.error_kev.toFixed(1)} keV</span>
                                    </div>
                                </div>`;
                        }
                    }
                }

                document.getElementById('info').innerHTML = `
                    <div style="font-size:1.8em; margin-bottom:5px; color:#fff">${d.label}</div>
                    <div style="font-size:1.3em; margin-bottom:8px;"><span class="formula">${d.formula}</span></div>
                    <div style="color:#888; font-size:0.9em;">${d.description || ''}</div>
                    ${resHtml}
                    ${mesonHtml}`;
            } else {
                const fullFormula = d.correction ? d.formula + ' ' + d.correction : d.formula;
                // Use pre-calculated values from Python
                const calcMev = d.calc_mev || 0;
                const expMev = d.actual_mev || 0;
                const errorKev = d.error_kev || 0;
                const unc = d.uncertainty || 1.0;
                const sigma = d.sigma || 0;
                const sigmaColor = getSigmaColor(sigma);
                const sigmaText = sigma < 100 ? sigma.toFixed(2) + 'σ' : '>100σ';
                const errorSign = errorKev >= 0 ? '+' : '';

                // Build magnetic moment section if data exists
                let magHtml = '';
                const mm = magMoments[d.id];
                if (mm) {
                    const magError = ((mm.value - mm.exp) / mm.exp * 100).toFixed(2);
                    magHtml = `
                        <hr style="border-color: #333; margin: 12px 0;">
                        <div style="color: #f39c12; font-size: 0.9em; margin-bottom: 5px;">MAGNETIC MOMENT</div>
                        <div><span class="label">μ formula:</span> <span style="color: #f39c12;">${mm.formula}</span></div>
                        <div><span class="label">Calculated:</span> ${mm.sign}${mm.value.toFixed(3)} ${mm.unit}</div>
                        <div><span class="label">Experimental:</span> ${mm.sign}${mm.exp} ${mm.unit}</div>
                        <div><span class="label">Error:</span> ${magError}%</div>
                    `;
                }

                const baseMev = d.base_mev || 0;
                const corrMev = d.corr_mev || 0;
                const hasCorr = d.correction && corrMev !== 0;

                document.getElementById('info').innerHTML = `
                    <div style="font-size:1.8em; margin-bottom:5px; color:#fff">${d.label.split('\n')[0]} <span style="font-size:0.55em; color:#888; margin-left:6px">${d.spin}<sup>${d.charge > 0 ? '+' : d.charge < 0 ? '−' : '0'}</sup></span></div>
                    <div style="font-size:1.1em; margin-bottom:4px; display:flex; justify-content:space-between;">
                        <span class="formula">${d.formula}</span>
                        <span style="color:#888; margin-left:12px">${baseMev.toFixed(2)}</span>
                    </div>
                    ${hasCorr ? `<div style="font-size:1.1em; margin-bottom:8px; display:flex; justify-content:space-between;">
                        <span class="formula">${d.correction}</span>
                        <span style="color:#888; margin-left:12px">${corrMev >= 0 ? '+' : ''}${corrMev.toFixed(2)}</span>
                    </div>` : ''}
                    <hr style="border-color:#333; margin:12px 0">
                    <div><span class="label">Calculated:</span> <span class="value">${calcMev.toFixed(4)} MeV</span></div>
                    <div><span class="label">Experimental:</span> <span class="value">${expMev.toFixed(4)} MeV</span></div>
                    <div><span class="label">Uncertainty:</span> <span class="value">±${unc < 0.001 ? (unc*1e6).toFixed(2) + ' eV' : unc < 1 ? (unc*1000).toFixed(1) + ' keV' : unc.toFixed(2) + ' MeV'}</span></div>
                    <hr style="border-color:#333; margin:12px 0">
                    <div><span class="label">Error:</span> <span style="color:${sigmaColor}">${errorSign}${Math.abs(errorKev) < 1 ? (errorKev*1000).toFixed(1) + ' eV' : errorKev.toFixed(2) + ' keV'}</span></div>
                    <div><span class="label">Deviation:</span> <span style="color:${sigmaColor}; font-weight:bold">${sigmaText}</span></div>
                    ${magHtml}`;

                updateDecays(d.id);
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            cy.destroy();
            initCy(tab);
            document.getElementById('info').innerHTML = '<p style="color:#666">Click a node</p>';
            document.getElementById('decays').innerHTML = '<p style="color:#666">Select a particle to see decay modes</p>';
        }

        // Decay database (keys match node_id values)
        const decayData = {
            'p': { stable: true, lifetime: '> 10³⁴ years' },
            'n': {
                lifetime: '~879 s (15 min)',
                note: 'Longest weak decay! Tiny Q-value (782 keV).',
                modes: [
                    { products: 'p + e⁻ + ν̄ₑ', percent: 100, type: 'weak' }
                ]
            },
            'D': {
                lifetime: '~5×10⁻²⁴ s',
                note: 'Resonance, decays via strong force',
                modes: [
                    { products: 'N + π', percent: 99.4, type: 'strong' },
                    { products: 'N + γ', percent: 0.6, type: 'em' }
                ]
            },
            'L0': {
                lifetime: '2.6×10⁻¹⁰ s',
                modes: [
                    { products: 'p + π⁻', percent: 63.9, type: 'weak' },
                    { products: 'n + π⁰', percent: 35.8, type: 'weak' }
                ]
            },
            'S_plus': {
                lifetime: '0.80×10⁻¹⁰ s',
                modes: [
                    { products: 'p + π⁰', percent: 51.6, type: 'weak' },
                    { products: 'n + π⁺', percent: 48.3, type: 'weak' }
                ]
            },
            'S_zero': {
                lifetime: '7.4×10⁻²⁰ s',
                note: 'EM decay! Only ground-state baryon.',
                modes: [
                    { products: 'Λ + γ', percent: 100, type: 'em' }
                ]
            },
            'S_minus': {
                lifetime: '1.48×10⁻¹⁰ s',
                modes: [
                    { products: 'n + π⁻', percent: 99.8, type: 'weak' }
                ]
            },
            'Ss_plus': {
                lifetime: '~1.7×10⁻²³ s',
                modes: [
                    { products: 'Λ + π⁺', percent: 87, type: 'strong' },
                    { products: 'Σ + π', percent: 12, type: 'strong' }
                ]
            },
            'Ss_zero': {
                lifetime: '~1.7×10⁻²³ s',
                modes: [
                    { products: 'Λ + π⁰', percent: 87, type: 'strong' },
                    { products: 'Σ + π', percent: 12, type: 'strong' }
                ]
            },
            'Ss_minus': {
                lifetime: '~1.7×10⁻²³ s',
                modes: [
                    { products: 'Λ + π⁻', percent: 87, type: 'strong' },
                    { products: 'Σ + π', percent: 12, type: 'strong' }
                ]
            },
            'X_zero': {
                lifetime: '2.9×10⁻¹⁰ s',
                modes: [
                    { products: 'Λ + π⁰', percent: 99.5, type: 'weak' }
                ]
            },
            'X_minus': {
                lifetime: '1.6×10⁻¹⁰ s',
                modes: [
                    { products: 'Λ + π⁻', percent: 99.9, type: 'weak' }
                ]
            },
            'Xs_zero': {
                lifetime: '~7×10⁻²³ s',
                modes: [
                    { products: 'Ξ + π', percent: 100, type: 'strong' }
                ]
            },
            'Xs_minus': {
                lifetime: '~7×10⁻²³ s',
                modes: [
                    { products: 'Ξ + π', percent: 100, type: 'strong' }
                ]
            },
            'Om': {
                lifetime: '0.82×10⁻¹⁰ s',
                note: 'Spin-3/2 but NO strong decay!',
                modes: [
                    { products: 'Λ + K⁻', percent: 67.8, type: 'weak' },
                    { products: 'Ξ⁰ + π⁻', percent: 23.6, type: 'weak' },
                    { products: 'Ξ⁻ + π⁰', percent: 8.6, type: 'weak' }
                ]
            },
            'Lc': {
                lifetime: '2.0×10⁻¹³ s',
                modes: [
                    { products: 'Λ + π⁺ + ...', percent: 35, type: 'weak' },
                    { products: 'pK̄⁰', percent: 3.2, type: 'weak' }
                ]
            },
            'Lb': {
                lifetime: '1.5×10⁻¹² s',
                modes: [
                    { products: 'Λc⁺ + ...', percent: 60, type: 'weak' },
                    { products: 'p + ...', percent: 30, type: 'weak' }
                ]
            }
        };

        function updateDecays(id) {
            const decay = decayData[id];
            let html = '';

            if (!decay) {
                html = '<p style="color: #666;">No decay data for this particle</p>';
            } else if (decay.stable) {
                html = `<div style="color: #2ecc71; font-size: 1.1em;">STABLE</div>
                        <div style="color: #888; margin-top: 5px;">τ ${decay.lifetime}</div>`;
            } else {
                html = `<div style="color: #888; margin-bottom: 10px;">τ = ${decay.lifetime}</div>`;
                if (decay.note) {
                    html += `<div style="color: #f39c12; margin-bottom: 10px; font-size: 0.9em;">${decay.note}</div>`;
                }
                decay.modes.forEach(m => {
                    const percent = typeof m.percent === 'number' ? m.percent.toFixed(1) + '%' : m.percent;
                    html += `
                        <div class="decay-mode ${m.type}">
                            <span class="decay-percent">${percent}</span>
                            ${m.products}
                        </div>
                    `;
                });
            }

            document.getElementById('decays').innerHTML = html;
        }

        initCy('light');
    </script>
</body>
</html>